import{h as S,u as V,i as x,j as D,k as h,o as d,c as i,l as a,a as e,F as y,r as B,e as u,t as _,d as N,m as C,n}from"./index-WXTl0fys.js";import{a as w}from"./axios-G2rPRu76.js";import{P as $}from"./ProgessBarComponent-RkcMoUBd.js";import{L}from"./LoadingComponent-WMBPQsFW.js";import{t as O}from"./sweetalert-7F7hic-m.js";var q={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"taiwang",VITE_MAP:"AIzaSyB8xClOZxLQMzkbq6jjN2KlrBmFPPJkvEA",BASE_URL:"/TaiWang-Order-Online/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const R={class:"bg-wave"},j={class:"container"},K={class:"col-lg-10 mx-auto pb-72"},M={class:"row gy-48 gy-lg-0"},z={key:0,class:"col-lg-7"},F=e("h2",{class:"h5 bg-gray text-light ps-12 py-16 mb-0"},"訂購資訊",-1),H={class:"border border-dark bg-white"},U={class:"ps-12 py-16"},J={class:"row"},Q=e("label",{for:"name",class:"col-3 col-lg-2 col-form-label"},"姓名：",-1),W={class:"col-9 col-lg-10"},Z=["value"],G={class:"row"},X=e("label",{for:"tel",class:"col-3 col-lg-2 col-form-label"},"手機：",-1),Y={class:"col-9 col-lg-10"},ee=["value"],te={class:"row"},se=e("label",{for:"email",class:"col-3 col-lg-2 col-form-label"},"Email：",-1),oe={class:"col-9 col-lg-10"},le=["value"],ae={class:"row"},re=e("label",{for:"address",class:"col-3 col-lg-2 col-form-label"},"地址：",-1),ne={class:"col-9 col-lg-10"},ce=["value"],de={class:"row"},ie=e("label",{for:"message",class:"col-3 col-lg-2 col-form-label"},"備註：",-1),ue={class:"col-9 col-lg-10"},me=["value"],_e=e("h2",{class:"h5 bg-gray text-light ps-12 py-16 mb-0"},"訂購品項",-1),pe={class:"border border-dark bg-white"},ve={class:"px-12 py-16"},he={class:"table-responsive"},ge={class:"table table-borderless mb-0"},be=e("thead",{class:"border-bottom border-dark border-top-0 border-start-0 border-end-0 text-nowrap"},[e("tr",null,[e("th",{scope:"col"},"餐點名稱"),e("th",{scope:"col"},"數量"),e("th",{scope:"col"},"單價")])],-1),fe={class:"text-nowrap border-bottom border-dark"},xe={class:"text-notoSans"},ye={class:"ps-12 mt-24 fs-6 fw-bold mb-4"},Ne={class:"text-notoSans"},we={key:0,class:"text-danger fs-7"},ke={class:"col-lg-5"},Ie=e("h2",{class:"h5 bg-gray text-light ps-12 py-16 mb-0"},"信用卡資訊",-1),Ee={class:"border border-dark bg-white"},Pe=e("label",{for:"cardNum1",class:"form-label"},[u("信用卡卡號 "),e("span",{class:"text-danger"},"*")],-1),Te={class:"d-flex align-items-center mb-20"},Ae=e("span",{class:"px-6"},"-",-1),Se=e("span",{class:"px-6"},"-",-1),Ve=e("span",{class:"px-6"},"-",-1),De=e("label",{for:"validDate",class:"form-label"},[u("有效年月 "),e("span",{class:"text-danger"},"*")],-1),Be=e("label",{for:"securityNum",class:"form-label mt-20"},[u("安全碼 "),e("span",{class:"text-danger"},"*")],-1),Ce=e("div",{class:"text-end mt-24"},[e("button",{type:"submit",class:"btn btn-primary text-white"},"確認付款")],-1),Ke={__name:"PaymentView",setup($e){const{VITE_API:g,VITE_APIPATH:b}=q,p=S(),k=V(),s=x({}),m=x(!0);localStorage.setItem("orderNum",p.params.id),w.get(`${g}/api/${b}/order/${p.params.id}`).then(t=>{s.value=t.data.order,m.value=!1}).catch(t=>{m.value=!1,console.log(t)});function v(t){const o=parseInt(t.target.getAttribute("maxlength"));t.target.value.length===o&&t.target.nextElementSibling.nextElementSibling.focus()}function I(t){return t?!0:"請選擇有效年/月"}function E(t){return/\d{3}/.test(t)?!0:"請輸入卡片背面末3碼數字"}function P(){w.post(`${g}/api/${b}/pay/${p.params.id}`).then(()=>{O("top","success","已成功付款"),setTimeout(()=>{k.push("/orderChecked")},1500)}).catch(t=>{console.log(t)})}const T=D(()=>{if(s.value&&s.value.products)return Object.values(s.value.products).reduce((t,o)=>t+o.total,0)});return(t,o)=>{const r=h("v-field"),f=h("error-message"),A=h("v-form");return d(),i(y,null,[a(L,{active:m.value,"onUpdate:active":o[0]||(o[0]=l=>m.value=l)},null,8,["active"]),e("div",R,[e("div",j,[e("div",K,[a($),e("div",M,[s.value&&s.value.user?(d(),i("div",z,[F,e("div",H,[e("div",U,[e("div",J,[Q,e("div",W,[e("input",{type:"text",class:"form-control-plaintext",id:"name",value:s.value.user.name,readonly:""},null,8,Z)])]),e("div",G,[X,e("div",Y,[e("input",{type:"tel",class:"form-control-plaintext",id:"tel",value:s.value.user.tel,readonly:""},null,8,ee)])]),e("div",te,[se,e("div",oe,[e("input",{type:"email",class:"form-control-plaintext",id:"email",value:s.value.user.email,readonly:""},null,8,le)])]),e("div",ae,[re,e("div",ne,[e("input",{type:"text",class:"form-control-plaintext",id:"address",value:s.value.user.address,readonly:""},null,8,ce)])]),e("div",de,[ie,e("div",ue,[e("input",{type:"text",class:"form-control-plaintext",id:"message",value:s.value.message?s.value.message:"無",readonly:""},null,8,me)])])])]),_e,e("div",pe,[e("div",ve,[e("div",he,[e("table",ge,[be,e("tbody",fe,[(d(!0),i(y,null,B(s.value.products,l=>(d(),i("tr",{key:l.id,class:"align-middle"},[e("td",null,_(l.product.title),1),e("td",null,_(l.qty),1),e("td",null,[u("NT$ "),e("span",xe,_(l.product.price),1)])]))),128))])])]),e("p",ye,[u("總金額：NT$ "),e("span",Ne,_(Math.round(s.value.total)),1),s.value.total!==T.value?(d(),i("span",we,"﹙已使用優惠折扣﹚")):N("",!0)])])])])):N("",!0),e("div",ke,[Ie,e("div",Ee,[a(A,{ref:"form",class:"px-12 py-16",onSubmit:P},{default:C(({errors:l})=>[Pe,e("div",Te,[a(r,{id:"cardNum1",name:"cardNum1",type:"text",class:n(["form-control border-gray w-20",{"is-invalid":l.cardNum1}]),onKeyup:o[1]||(o[1]=c=>v(c)),rules:{required:!0,regex:/\d{4}/},maxlength:"4"},null,8,["class"]),Ae,a(r,{name:"cardNum2",type:"text",class:n(["form-control border-gray w-20",{"is-invalid":l.cardNum2}]),onKeyup:o[2]||(o[2]=c=>v(c)),rules:{required:!0,regex:/\d{4}/},maxlength:"4"},null,8,["class"]),Se,a(r,{name:"cardNum3",type:"text",class:n(["form-control border-gray w-20",{"is-invalid":l.cardNum3}]),onKeyup:o[3]||(o[3]=c=>v(c)),rules:{required:!0,regex:/\d{4}/},maxlength:"4"},null,8,["class"]),Ve,a(r,{name:"cardNum4",type:"text",class:n(["form-control border-gray w-20",{"is-invalid":l.cardNum4}]),rules:{required:!0,regex:/\d/},maxlength:"4"},null,8,["class"])]),De,a(r,{id:"validDate",name:"validDate",type:"month",class:n(["form-control border-gray",{"is-invalid":l.validDate}]),rules:I},null,8,["class"]),a(f,{name:"validDate",class:"invalid-feedback"}),Be,a(r,{id:"securityNum",name:"securityNum",type:"text",class:n(["form-control border-gray",{"is-invalid":l.securityNum}]),placeholder:"請輸入卡片背面末3碼",rules:E,maxlength:"3"},null,8,["class"]),a(f,{name:"securityNum",class:"invalid-feedback"}),Ce]),_:1},512)])])])])])])],64)}}};export{Ke as default};
