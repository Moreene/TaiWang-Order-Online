import{P as V}from"./ProgessBarComponent-Jenl9AO4.js";import{L as D}from"./LoadingComponent-q-1pQjMq.js";import{t as B}from"./sweetalert-8fODVnWy.js";import{h as C,u as $,i as y,j as L,k as b,o as u,c as m,l as r,b as a,x as O,a as e,F as N,r as q,e as _,t as p,d as w,m as R,n as c}from"./index-Acea3fQg.js";import{a as k}from"./axios-G2rPRu76.js";var j={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"taiwang",VITE_MAP:"AIzaSyB8xClOZxLQMzkbq6jjN2KlrBmFPPJkvEA",BASE_URL:"/TaiWang-Order-Online/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const K={class:"bg-wave"},M={class:"container"},z={class:"col-lg-10 mx-auto pb-72"},F={class:"row gy-48 gy-lg-0"},H={key:0,class:"col-lg-7"},U=e("h2",{class:"h5 bg-gray text-light ps-12 py-16 mb-0"},"訂購資訊",-1),J={class:"border border-dark bg-white"},Q={class:"ps-12 py-16"},W={class:"row"},Z=e("label",{for:"name",class:"col-3 col-lg-2 col-form-label"},"姓名：",-1),G={class:"col-9 col-lg-10"},X=["value"],Y={class:"row"},ee=e("label",{for:"tel",class:"col-3 col-lg-2 col-form-label"},"手機：",-1),se={class:"col-9 col-lg-10"},te=["value"],oe={class:"row"},le=e("label",{for:"email",class:"col-3 col-lg-2 col-form-label"},"Email：",-1),ae={class:"col-9 col-lg-10"},re=["value"],ne={class:"row"},ce=e("label",{for:"address",class:"col-3 col-lg-2 col-form-label"},"地址：",-1),de={class:"col-9 col-lg-10"},ie=["value"],ue={class:"row"},me=e("label",{for:"message",class:"col-3 col-lg-2 col-form-label"},"備註：",-1),_e={class:"col-9 col-lg-10"},pe=["value"],he=e("h2",{class:"h5 bg-gray text-light ps-12 py-16 mb-0"},"訂購品項",-1),ge={class:"border border-dark bg-white"},be={class:"px-12 py-16"},ve={class:"table-responsive"},fe={class:"table table-borderless mb-0"},xe=e("thead",{class:"border-bottom border-dark border-top-0 border-start-0 border-end-0 text-nowrap"},[e("tr",null,[e("th",{scope:"col"},"餐點名稱"),e("th",{scope:"col"},"數量"),e("th",{scope:"col"},"單價")])],-1),ye={class:"text-nowrap border-bottom border-dark"},Ne={class:"text-notoSans"},we={class:"ps-12 mt-24 fs-6 fw-bold mb-4"},ke={class:"text-notoSans"},Ie={key:0,class:"text-danger fs-7"},Ee={class:"col-lg-5"},Pe=e("h2",{class:"h5 bg-gray text-light ps-12 py-16 mb-0"},"信用卡資訊",-1),Te={class:"border border-dark bg-white"},Ae=e("label",{for:"cardNum1",class:"form-label"},[_("信用卡卡號 "),e("span",{class:"text-danger"},"*")],-1),Se={class:"d-flex align-items-center mb-20"},Ve=e("span",{class:"px-6"},"-",-1),De=e("span",{class:"px-6"},"-",-1),Be=e("span",{class:"px-6"},"-",-1),Ce=e("label",{for:"validDate",class:"form-label"},[_("有效年月 "),e("span",{class:"text-danger"},"*")],-1),$e=e("label",{for:"securityNum",class:"form-label mt-20"},[_("安全碼 "),e("span",{class:"text-danger"},"*")],-1),Le=e("div",{class:"text-end mt-24"},[e("button",{type:"submit",class:"btn btn-primary text-white"},"確認付款")],-1),ze={__name:"PaymentView",setup(Oe){const{VITE_API:v,VITE_APIPATH:f}=j,h=C(),I=$(),t=y({}),d=y(!0);localStorage.setItem("orderNum",h.params.id),k.get(`${v}/api/${f}/order/${h.params.id}`).then(s=>{t.value=s.data.order,d.value=!1}).catch(s=>{d.value=!1,console.log(s)});function g(s){const o=parseInt(s.target.getAttribute("maxlength"));s.target.value.length===o&&s.target.nextElementSibling.nextElementSibling.focus()}function E(s){return s?!0:"請選擇有效年/月"}function P(s){return/\d{3}/.test(s)?!0:"請輸入卡片背面末3碼數字"}function T(){k.post(`${v}/api/${f}/pay/${h.params.id}`).then(()=>{B("top","success","已成功付款"),setTimeout(()=>{I.push("/orderChecked")},1500)}).catch(s=>{console.log(s)})}const A=L(()=>{if(t.value&&t.value.products)return Object.values(t.value.products).reduce((s,o)=>s+o.total,0)});return(s,o)=>{const n=b("v-field"),x=b("error-message"),S=b("v-form");return u(),m(N,null,[r(D,{active:a(d),"onUpdate:active":o[0]||(o[0]=l=>O(d)?d.value=l:null)},null,8,["active"]),e("div",K,[e("div",M,[e("div",z,[r(V),e("div",F,[a(t)&&a(t).user?(u(),m("div",H,[U,e("div",J,[e("div",Q,[e("div",W,[Z,e("div",G,[e("input",{type:"text",class:"form-control-plaintext",id:"name",value:a(t).user.name,readonly:""},null,8,X)])]),e("div",Y,[ee,e("div",se,[e("input",{type:"tel",class:"form-control-plaintext",id:"tel",value:a(t).user.tel,readonly:""},null,8,te)])]),e("div",oe,[le,e("div",ae,[e("input",{type:"email",class:"form-control-plaintext",id:"email",value:a(t).user.email,readonly:""},null,8,re)])]),e("div",ne,[ce,e("div",de,[e("input",{type:"text",class:"form-control-plaintext",id:"address",value:a(t).user.address,readonly:""},null,8,ie)])]),e("div",ue,[me,e("div",_e,[e("input",{type:"text",class:"form-control-plaintext",id:"message",value:a(t).message?a(t).message:"無",readonly:""},null,8,pe)])])])]),he,e("div",ge,[e("div",be,[e("div",ve,[e("table",fe,[xe,e("tbody",ye,[(u(!0),m(N,null,q(a(t).products,l=>(u(),m("tr",{key:l.id,class:"align-middle"},[e("td",null,p(l.product.title),1),e("td",null,p(l.qty),1),e("td",null,[_("NT$ "),e("span",Ne,p(l.product.price),1)])]))),128))])])]),e("p",we,[_("總金額：NT$ "),e("span",ke,p(Math.round(a(t).total)),1),a(t).total!==a(A)?(u(),m("span",Ie,"﹙已使用優惠折扣﹚")):w("",!0)])])])])):w("",!0),e("div",Ee,[Pe,e("div",Te,[r(S,{ref:"form",class:"px-12 py-16",onSubmit:T},{default:R(({errors:l})=>[Ae,e("div",Se,[r(n,{id:"cardNum1",name:"cardNum1",type:"text",class:c(["form-control border-gray w-20",{"is-invalid":l.cardNum1}]),onKeyup:o[1]||(o[1]=i=>g(i)),rules:{required:!0,regex:/\d{4}/},maxlength:"4"},null,8,["class"]),Ve,r(n,{name:"cardNum2",type:"text",class:c(["form-control border-gray w-20",{"is-invalid":l.cardNum2}]),onKeyup:o[2]||(o[2]=i=>g(i)),rules:{required:!0,regex:/\d{4}/},maxlength:"4"},null,8,["class"]),De,r(n,{name:"cardNum3",type:"text",class:c(["form-control border-gray w-20",{"is-invalid":l.cardNum3}]),onKeyup:o[3]||(o[3]=i=>g(i)),rules:{required:!0,regex:/\d{4}/},maxlength:"4"},null,8,["class"]),Be,r(n,{name:"cardNum4",type:"text",class:c(["form-control border-gray w-20",{"is-invalid":l.cardNum4}]),rules:{required:!0,regex:/\d/},maxlength:"4"},null,8,["class"])]),Ce,r(n,{id:"validDate",name:"validDate",type:"month",class:c(["form-control border-gray",{"is-invalid":l.validDate}]),rules:E},null,8,["class"]),r(x,{name:"validDate",class:"invalid-feedback"}),$e,r(n,{id:"securityNum",name:"securityNum",type:"text",class:c(["form-control border-gray",{"is-invalid":l.securityNum}]),placeholder:"請輸入卡片背面末3碼",rules:P,maxlength:"3"},null,8,["class"]),r(x,{name:"securityNum",class:"invalid-feedback"}),Le]),_:1},512)])])])])])])],64)}}};export{ze as default};
