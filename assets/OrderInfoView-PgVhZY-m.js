import{a as N}from"./axios-G2rPRu76.js";import{u as L,Z as B,i as x,s as O,j as R,G as $,k as u,o as _,c as p,l as a,a as e,F as w,r as j,b,e as n,t as f,d as q,m as y,n as c}from"./index-GZPT54nk.js";import{u as M}from"./useCartStore-qS6C5yF9.js";import{P as D}from"./ProgessBarComponent-DkgnA_ZS.js";import{L as F}from"./LoadingComponent-2GsBsRAm.js";import{t as V}from"./sweetalert-fB6ucfd0.js";var z={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"taiwang",VITE_MAP:"AIzaSyB8xClOZxLQMzkbq6jjN2KlrBmFPPJkvEA",BASE_URL:"/TaiWang-Order-Online/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const H={class:"bg-wave"},Z={class:"container"},G={class:"col-lg-10 mx-auto pb-72"},J={class:"row justify-content-between gy-48 gy-lg-0"},K={class:"col-lg-6"},Q={class:"table-responsive"},W={class:"table table-borderless mb-0"},X=e("thead",{class:"border-bottom border-dark border-top-0 border-start-0 border-end-0 border-2 text-nowrap"},[e("tr",{class:"text-center"},[e("th",{scope:"col",class:"bg-wave",style:{width:"100px"}},"示意圖"),e("th",{scope:"col",class:"bg-wave"},"餐點名稱"),e("th",{scope:"col",class:"bg-wave"},"餐點數量"),e("th",{scope:"col",class:"bg-wave"},"單價")])],-1),Y={class:"text-center text-nowrap"},ee={scope:"row",class:"fw-normal bg-wave"},se=["src","alt"],te={class:"bg-wave"},oe={class:"bg-wave"},ae={class:"bg-wave"},le={class:"text-notoSans"},re={class:"text-end fw-bold fs-5 mt-16 mb-0"},ne=e("span",{class:"me-8"},"總計：",-1),de={class:"text-notoSans"},ce={key:0,class:"text-end fw-bold text-danger"},ie={class:"col-lg-5"},me={class:"border border-gray bg-white rounded-2 p-20"},ue=e("h2",{class:"h4 text-center fw-bold mb-24"},"訂購資訊",-1),_e={class:"mb-16"},pe=e("label",{for:"name",class:"form-label"},[n("姓名 "),e("span",{class:"text-danger"},"*")],-1),be={class:"mb-16"},fe=e("label",{for:"tel",class:"form-label"},[n("手機 "),e("span",{class:"text-danger"},"*")],-1),he={class:"mb-16"},ve=e("label",{for:"email",class:"form-label"},[n("Email "),e("span",{class:"text-danger"},"*")],-1),ge={class:"mb-16"},xe=e("label",{for:"address",class:"form-label"},[n("地址 "),e("span",{class:"text-danger"},"*")],-1),we={class:"mb-24"},ye=e("label",{for:"備註",class:"form-label"},"備註",-1),Ve={class:"d-flex justify-content-between"},ke=["disabled"],Ce={__name:"OrderInfoView",setup(Ie){const{VITE_API:k,VITE_APIPATH:I}=z,T=L(),o=B({user:{name:"",email:"",tel:"",address:""},message:""}),v=x(null),h=x(!0),g=M(),{getCart:E}=g;function P(l){return/^(09)[0-9]{8}$/.test(l)?!0:"請輸入 09 開頭的手機號碼"}function S(){N.post(`${k}/api/${I}/order`,{data:o}).then(l=>{const{orderId:s}=l.data;V("top","success","訂單已成立"),localStorage.removeItem("pickUp"),setTimeout(()=>{E(),T.push(`/payment/${s}`)},1500)}).catch(()=>{V("top","error","表單送出失敗")})}const{cart:i}=O(g),U=R(()=>{const{user:l}=o;return!l.name||!l.email||!l.tel||!l.address});return $(()=>{localStorage.getItem("pickUp")==="自取"&&(o.user.address="自取",v.value.$el.setAttribute("readonly","readonly"))}),setTimeout(()=>h.value=!1,400),(l,s)=>{const d=u("v-field"),m=u("error-message"),A=u("RouterLink"),C=u("v-form");return _(),p(w,null,[a(F,{active:h.value,"onUpdate:active":s[0]||(s[0]=t=>h.value=t)},null,8,["active"]),e("div",H,[e("div",Z,[e("div",G,[a(D),e("div",J,[e("div",K,[e("div",Q,[e("table",W,[X,e("tbody",Y,[(_(!0),p(w,null,j(b(i).carts,t=>(_(),p("tr",{key:t.id,class:"align-middle border-bottom border-dark"},[e("th",ee,[e("img",{src:t.product.imageUrl,alt:t.product.title,style:{width:"100px",height:"100px"}},null,8,se)]),e("td",te,f(t.product.title),1),e("td",oe,f(t.qty),1),e("td",ae,[n("NT$ "),e("span",le,f(t.product.price),1)])]))),128))])])]),e("p",re,[ne,n("NT$ "),e("span",de,f(Math.round(b(i).final_total)),1)]),b(i).final_total!==b(i).total?(_(),p("p",ce,"(已使用優惠代碼)")):q("",!0)]),e("div",ie,[e("div",me,[ue,a(C,{onSubmit:S},{default:y(({errors:t})=>[e("div",_e,[pe,a(d,{id:"name",name:"姓名",type:"text",class:c(["form-control border-gray",{"is-invalid":t.姓名}]),modelValue:o.user.name,"onUpdate:modelValue":s[1]||(s[1]=r=>o.user.name=r),placeholder:"請輸入姓名",rules:"required"},null,8,["modelValue","class"]),a(m,{name:"姓名",class:"invalid-feedback fw-bold"})]),e("div",be,[fe,a(d,{id:"tel",name:"手機",type:"tel",class:c(["form-control border-gray",{"is-invalid":t.手機}]),modelValue:o.user.tel,"onUpdate:modelValue":s[2]||(s[2]=r=>o.user.tel=r),placeholder:"請輸入手機號碼",rules:P},null,8,["modelValue","class"]),a(m,{name:"手機",class:"invalid-feedback fw-bold"})]),e("div",he,[ve,a(d,{id:"email",name:"email",type:"email",class:c(["form-control border-gray",{"is-invalid":t.email}]),modelValue:o.user.email,"onUpdate:modelValue":s[3]||(s[3]=r=>o.user.email=r),placeholder:"請輸入 Email",rules:"email|required"},null,8,["modelValue","class"]),a(m,{name:"email",class:"invalid-feedback fw-bold"})]),e("div",ge,[xe,a(d,{id:"address",name:"地址",type:"text",class:c(["form-control border-gray",{"is-invalid":t.地址}]),modelValue:o.user.address,"onUpdate:modelValue":s[4]||(s[4]=r=>o.user.address=r),placeholder:"請輸入地址",rules:"required",ref_key:"address",ref:v},null,8,["modelValue","class"]),a(m,{name:"地址",class:"invalid-feedback fw-bold"})]),e("div",we,[ye,a(d,{as:"textarea",id:"備註",name:"備註",class:c(["form-control border-gray",{"is-invalid":t.備註}]),modelValue:o.message,"onUpdate:modelValue":s[5]||(s[5]=r=>o.message=r),style:{height:"150px"}},null,8,["modelValue","class"])]),e("div",Ve,[a(A,{to:"/cart",class:"btn btn-outline-dark"},{default:y(()=>[n("回上一頁")]),_:1}),e("button",{type:"submit",class:"btn btn-primary text-white",disabled:U.value},"送出訂單",8,ke)])]),_:1})])])])])])])],64)}}};export{Ce as default};
